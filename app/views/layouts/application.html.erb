<!DOCTYPE html>
<html>
<head>
  <title>JD Rampage - The JDHS Student Newspaper</title>
  <%= stylesheet_link_tag 'blueprint/screen', :media => 'screen, projection' %>
  <%= stylesheet_link_tag 'blueprint/print', :media => 'print' %>
	<!--[if IE]><%= stylesheet_link_tag 'blueprint/ie', :media => 'screen, projection' %><![endif]-->
	<%= stylesheet_link_tag 'scaffold','application','global','articles','sections','pages'%>
	<%= javascript_include_tag "jquery-1.4.2.min.js","jquery-ui-1.8.4.custom.min.js" %>
	<%= javascript_include_tag :defaults %>
  <%= csrf_meta_tag %> <!-- prevents cross-site request forgery -->
</head>
<body>
<div id="header">
	<%= link_to "rampage", '/', :id => 'top_text' %>
	<div id="top_subtext">The JDHS Student Newspaper</div>
	<ul id="section_header_list">
		<% for section in Section.all %>
			<li class="section_item"><%= link_to section.name, section_path(section) %></li>
		<% end %>
	</ul>

  <div id="notification_area">
    <%= show_free_space_if_active('Notification') %>
  </div>

	<% if logged_in? %>
		<div id="login_area">
			Logged in as <b><%= current_user.login %></b> |
			<%= link_to 'The Back', admin_path %> |
			<%= link_to 'The Front', root_path, :style=>"font-weight:bold" %> |
			<%= link_to 'Logout', logout_path %>
		</div>
	<% end %>
</div>
<hr>
<div class="container" id="main">
	<div id="flashes">
		<% if flash[:notice] %>
			<div id='notice'><%= flash[:notice] %></div>
		<% end %>
	</div>
	<div class="span-3 colborder" id="left_sidebar">
  	<% sidebar_articles = Article.all.sample(16) %> <!--variable declaration...-->
		<% sidebar_articles[0..1].each do |article| %>
			<%= render :partial => "articles/partials/article_no_image_preview", :locals => { :article => article } %>
		<% end %>

		<%= yield :left_sidebar %>

		<% sidebar_articles[2..7].each do |article| %>
			<%= render :partial => "articles/partials/article_no_image_preview", :locals => { :article => article } %>
		<% end %>
	</div>
	<div class="span-14 colborder">
		<%= yield %>
	</div>
	<div class="span-5 last" id="right_sidebar"> <!--keep span sum to < 23-->
	  <%= link_to "Subscribe", new_subscriber_path, :id => "subscribe", :class => "right button" %>

		<% sidebar_articles[8..9].each do |article| %>
			<% if rand(2) == 0 %>
				<%= render :partial => "articles/partials/article_sidebar_image_preview", :locals => { :article => article } %>
			<% else %>
				<%= render :partial => "articles/partials/article_no_image_preview", :locals => { :article => article } %>
			<% end%>
		<% end %>

		<%= yield :right_sidebar %>

		<% sidebar_articles[10..15].each do |article| %>
      <% if rand(2) == 0 %>
	      <%= render :partial => "articles/partials/article_sidebar_image_preview", :locals => { :article => article } %>
      <% else %>
	      <%= render :partial => "articles/partials/article_no_image_preview", :locals => { :article => article } %>
      <% end%>
    <% end %>
	</div>
</div>
<hr>
<div id="footer">
	<% unless logged_in? %>
	<div id="login_area">
		<a href="javascript:void(0)" id="login_activator">Login</a>
	</div>
	<% end %>

	<ul id="pages_row">
		<% Page.all.each do |page| %>
			<%= content_tag_for :li, page do %>
				<%= link_to page.title, page %>
			<% end %>
		<% end %>
	</ul>

	<div id="login_form"><!--style="display:none">-->
		<%= render :partial => "user_sessions/new" %>
	</div>
</div>

</body>
</html>

